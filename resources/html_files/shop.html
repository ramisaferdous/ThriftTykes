<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Shop</title>
    <link rel="stylesheet" href="/css_files/shop.css">
</head>

<body>
    <h1>My Shop</h1>
    <h3>Add a New Product</h3>
    <form id="addProductForm">
        <input type="text" name="productName" placeholder="Product Name" required>
        <select name="category">
            <option value="clothing">Clothing</option>
            <option value="toys">Toys</option>
        </select>
        <input type="text" name="size" placeholder="Size" required>
        <input type="text" name="brand" placeholder="Brand">
        <select name="condition">
            <option value="new">New</option>
            <option value="used">Used</option>
        </select>
        <input type="number" name="price" placeholder="Price" required>
        <button type="submit">Add Product</button>
    </form>
    <h3>Your Products</h3>
    <div id="productsList"></div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            fetchProducts();
        });
        function fetchProducts() {
            fetch('/shop')
                .then(response => response.json())
                .then(data => {
                    const productsList = document.getElementById("productsList");
                    productsList.innerHTML = "";
                    data.forEach(product => {
                        const productItem = document.createElement("div");
                        productItem.innerHTML = `
         <p><strong>${product.name}</strong> - $${product.price}</p>
                            <button onclick="deleteProduct('${product.id}')">Delete</button>
                            <hr>
                        `;
                        productsList.appendChild(productItem);
                    });
                })
                .catch(error => console.error("Error fetching products:", error));
            }
            document.getElementById("addProductForm").addEventListener("submit", function (event) {
            event.preventDefault();
            const formData = new FormData(this);
            fetch("/shop/add", {
                method: "POST",
                body: new URLSearchParams(formData)
            }).then(() => {
                fetchProducts();
                this.reset();
            }).catch(error => console.error("Error adding product:", error));
        });

        function deleteProduct(productId) {
            fetch(`/shop/delete/${productId}`, { method: "POST" })
                .then(() => fetchProducts())
                .catch(error => console.error("Error deleting product:", error));
        }
    </script>

</body>
</html>